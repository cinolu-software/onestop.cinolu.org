<div class="relative bg-primary-600 rounded-2xl shadow-lg overflow-hidden">
  <div class="relative px-4 md:px-8 py-4 md:py-10">
    <div class="flex items-start justify-between gap-6 mb-4">
      <div class="flex-1">
        <div class="flex items-center gap-4 mb-4">
          @if (user().profile) {
          <div class="relative h-20 w-20 rounded-2xl ring-4 ring-white shadow-xl bg-gray-100 overflow-hidden">
            <img [alt]="user().name" [ngSrc]="user() | apiIMG : 'user'" class="object-cover" fill priority />
          </div>
          } @else {
          <div class="h-14 w-14 md:w-28 md:h-28 rounded-full bg-white flex items-center justify-center">
            <i-lucide [img]="icons.User" class="md:size-16 size-8" />
          </div>
          }
          <div class="flex flex-col gap-1">
            <h1 class="text-2xl md:text-4xl font-bold text-white leading-tight">{{ user().name }}</h1>
            <div class="flex items-center gap-2 text-white/80">
              <i-lucide [name]="icons.Calendar" class="w-4 h-4" />
              <span class="text-sm">Membre depuis le {{ user().created_at | date : 'dd MMM yyyy' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 pt-8 border-t border-white/20">
      <div class="flex items-center gap-4">
        <div
          class="flex items-center justify-center size-10 bg-white/10 backdrop-blur-sm rounded-xl border border-white/20">
          <i-lucide [name]="icons.Mail" class="size-5 text-white" />
        </div>
        <div>
          <div class="text-xs text-white/70 mb-1">Email</div>
          <div class="text-sm md:text-base font-bold text-white truncate">
            {{ user().email }}
          </div>
        </div>
      </div>
      <div class="flex items-center gap-4">
        <div
          class="flex items-center justify-center size-10 bg-white/10 backdrop-blur-sm rounded-xl border border-white/20">
          <i-lucide [name]="icons.Phone" class="size-5 text-white" />
        </div>
        <div>
          <div class="text-xs text-white/70 mb-1">Téléphone</div>
          <div class="text-sm md:text-base font-bold text-white">
            {{ user().phone_number || 'Non renseigné' }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 my-6">
  <div
    class="group relative bg-white rounded-xl shadow-sm border border-gray-200 p-5 hover:shadow-md hover:border-primary-300 transition-all duration-300">
    <div class="relative">
      <div
        class="inline-flex items-center justify-center w-11 h-11 bg-primary-50 rounded-xl mb-3 group-hover:scale-105 transition-transform">
        <i-lucide [name]="icons.User" class="w-5 h-5 text-primary-600" />
      </div>
      <div class="text-xs font-medium text-gray-500 mb-1.5">Genre</div>
      <div class="text-base font-semibold text-gray-900">
        {{ user().gender || '—' }}
      </div>
    </div>
  </div>
  <div
    class="group relative bg-white rounded-xl shadow-sm border border-gray-200 p-5 hover:shadow-md hover:border-primary-300 transition-all duration-300">
    <div class="relative">
      <div
        class="inline-flex items-center justify-center w-11 h-11 bg-primary-50 rounded-xl mb-3 group-hover:scale-105 transition-transform">
        <i-lucide [name]="icons.MapPin" class="w-5 h-5 text-primary-600" />
      </div>
      <div class="text-xs font-medium text-gray-500 mb-1.5">Localisation</div>
      <div class="text-base font-semibold text-gray-900 truncate">
        {{ user().city && user().country ? user().city + ', ' + user().country : 'Non spécifié' }}
      </div>
    </div>
  </div>
  <div
    class="group relative bg-white rounded-xl shadow-sm border border-gray-200 p-5 hover:shadow-md hover:border-primary-300 transition-all duration-300">
    <div class="relative">
      <div
        class="inline-flex items-center justify-center w-11 h-11 bg-primary-50 rounded-xl mb-3 group-hover:scale-105 transition-transform">
        <i-lucide [name]="icons.Calendar" class="w-5 h-5 text-primary-600" />
      </div>
      <div class="text-xs font-medium text-gray-500 mb-1.5">Date de naissance</div>
      <div class="text-base font-semibold text-gray-900">
        {{ user().birth_date ? (user().birth_date | date : 'dd MMM yyyy') : '—' }}
      </div>
    </div>
  </div>
  <div
    class="group relative bg-white rounded-xl shadow-sm border border-gray-200 p-5 hover:shadow-md hover:border-primary-300 transition-all duration-300">
    <div class="relative">
      <div
        class="inline-flex items-center justify-center w-11 h-11 bg-primary-50 rounded-xl mb-3 group-hover:scale-105 transition-transform">
        <i-lucide [name]="icons.Shield" class="w-5 h-5 text-primary-600" />
      </div>
      <div class="text-xs font-medium text-gray-500 mb-1.5">Rôles</div>
      <div class="text-base font-semibold text-gray-900">
        {{ user().roles && user().roles.length > 0 ? user().roles.length : 0 }} rôle(s)
      </div>
    </div>
  </div>
</div>

<app-ui-accordion [multiple]="true">
  @if (user().biography) {
  <app-ui-accordion-panel value="0">
    <app-ui-accordion-header>
      <div class="flex items-center gap-2 w-full py-2 px-2">
        <i-lucide [name]="icons.FileText" class="w-5 h-5 text-secondary-600" />
        <h5 class="font-medium text-gray-900">Biographie</h5>
      </div>
    </app-ui-accordion-header>
    <app-ui-accordion-content>
      <p class="text-gray-700 leading-relaxed whitespace-pre-line">
        {{ user().biography || 'Aucune biographie disponible pour le moment.' }}
      </p>
    </app-ui-accordion-content>
  </app-ui-accordion-panel>
  } @if (user().participated_projects && user().participated_projects.length > 0) {
  <app-ui-accordion-panel value="1">
    <app-ui-accordion-header>
      <div class="flex items-center gap-2 w-full py-2 px-2">
        <i-lucide [name]="icons.Briefcase" class="w-5 h-5 text-primary-600" />
        <h5 class="font-medium text-gray-900">Projets participés</h5>
      </div>
    </app-ui-accordion-header>
    <app-ui-accordion-content>
      <div class="space-y-2">
        @for (project of user().participated_projects; track project.id) {
        <div class="p-3 bg-gray-50 rounded-lg">
          <p class="font-semibold text-gray-900">{{ project.name }}</p>
        </div>
        }
      </div>
    </app-ui-accordion-content>
  </app-ui-accordion-panel>
  } @if (user().participated_events && user().participated_events.length > 0) {
  <app-ui-accordion-panel value="2">
    <app-ui-accordion-header>
      <div class="flex items-center gap-2 w-full py-2 px-2">
        <i-lucide [name]="icons.Calendar" class="w-5 h-5 text-secondary-600" />
        <h5 class="font-medium text-gray-900">Événements participés</h5>
      </div>
    </app-ui-accordion-header>
    <app-ui-accordion-content>
      <div class="space-y-2">
        @for (event of user().participated_events; track event.id) {
        <div class="p-3 bg-gray-50 rounded-lg">
          <p class="font-semibold text-gray-900">{{ event.name }}</p>
        </div>
        }
      </div>
    </app-ui-accordion-content>
  </app-ui-accordion-panel>
  }
</app-ui-accordion>
