<div
  class="group relative bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-lg transition-all duration-300 cursor-pointer overflow-hidden"
  role="button"
  tabindex="0"
  (click)="handleSelect()">
  @if (isSelected()) {
  <div class="h-1 bg-gradient-to-r from-primary-500 to-primary-600 opacity-100"></div>
  }
  <div class="p-5">
    <div class="absolute top-4 right-3 flex gap-1.5">
      <app-ui-button (clicked)="handleEdit($event)" variant="secondary" [outlined]="true" size="small">
        <i-lucide [name]="icons.edit" class="size-4" />
      </app-ui-button>
      <app-ui-button (clicked)="handleDelete($event)" variant="danger" [outlined]="true" size="small">
        <i-lucide [name]="icons.trash" class="size-4" />
      </app-ui-button>
    </div>
    <div class="pr-16">
      <div class="flex items-center gap-3 mb-4">
        <div
          class="relative flex items-center justify-center w-8 h-8 rounded-full bg-linear-to-br from-primary-500 to-primary-600 text-white font-bold text-sm shrink-0 ring-2 ring-white shadow-sm">
          {{ phase().order }}
        </div>
        <div class="flex-1 h-0.5 bg-gradient-to-r from-primary-200 to-transparent"></div>
      </div>
      <h6 class="font-semibold text-gray-900 text-base mb-2">{{ phase().name }}</h6>
      <div class="flex flex-wrap gap-2 mb-3">
        @if (phase().is_active) {
        <span
          class="inline-flex items-center px-2.5 py-1 text-xs font-medium bg-primary-100 text-primary-700 rounded-full ring-1 ring-primary-200">
          <span class="w-1.5 h-1.5 bg-primary-500 rounded-full mr-2"></span>
          Active
        </span>
        } @else {
        <span
          class="inline-flex items-center px-2.5 py-1 text-xs font-medium bg-gray-100 text-gray-600 rounded-full ring-1 ring-gray-200">
          <span class="w-1.5 h-1.5 bg-gray-400 rounded-full mr-2"></span>
          Inactive
        </span>
        } @if (phase().resources && phase().resources!.length > 0) {
        <span
          class="inline-flex items-center px-2.5 py-1 text-xs font-medium bg-blue-50 text-blue-700 rounded-full ring-1 ring-blue-200">
          <i-lucide [name]="icons.file" class="size-3 mr-1.5" />
          {{ phase().resources!.length }} ressource{{ phase().resources!.length > 1 ? 's' : '' }}
        </span>
        }
      </div>
      @if (phase().description) {
      <p class="text-sm text-gray-600 line-clamp-2 mb-3 leading-relaxed">
        {{ phase().description }}
      </p>
      } @if (phase().started_at || phase().ended_at) {
      <div class="pt-3 border-t border-gray-100">
        <div class="flex items-center justify-between text-xs text-gray-500 mt-3">
          @if (phase().started_at) {
          <div class="flex items-center gap-2">
            <i-lucide [name]="icons.calendar" class="size-3.5 text-primary-500" />
            <span class="font-medium text-gray-700">{{
              phase().started_at | date : 'dd MMM yyyy'
            }}</span>
          </div>
          } @if (phase().started_at && phase().ended_at) {
          <div class="flex-1 mx-2 h-0.5 bg-gradient-to-r from-primary-200 to-transparent"></div>
          } @if (phase().ended_at) {
          <div class="flex items-center gap-2">
            <span class="font-medium text-gray-700">{{
              phase().ended_at | date : 'dd MMM yyyy'
            }}</span>
            <i-lucide [name]="icons.checkCircle" class="size-3.5 text-primary-500" />
          </div>
          }
        </div>
      </div>
      }
    </div>
  </div>
</div>
